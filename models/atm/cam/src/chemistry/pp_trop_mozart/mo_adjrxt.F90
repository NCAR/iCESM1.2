




      module mo_adjrxt

      private
      public :: adjrxt

      contains

      subroutine adjrxt( rate, inv, m, ncol )

      use ppgrid, only : pver
      use shr_kind_mod, only : r8 => shr_kind_r8
      use chem_mods, only : nfs, rxntot

      implicit none

!--------------------------------------------------------------------
! ... dummy arguments
!--------------------------------------------------------------------
      integer, intent(in) :: ncol
      real(r8), intent(in) :: inv(ncol,pver,nfs)
      real(r8), intent(in) :: m(ncol,pver)
      real(r8), intent(inout) :: rate(ncol,pver,rxntot)

!--------------------------------------------------------------------
! ... local variables
!--------------------------------------------------------------------
      integer :: k
      real(r8) :: im(ncol)

      do k = 1,pver
         rate(:,k, 43) = rate(:,k, 43) * inv(:,k, 2)
         rate(:,k, 44) = rate(:,k, 44) * inv(:,k, 3)
         rate(:,k, 45) = rate(:,k, 45) * inv(:,k, 4)
         rate(:,k, 56) = rate(:,k, 56) * inv(:,k, 1)
         rate(:,k, 64) = rate(:,k, 64) * inv(:,k, 1)
         rate(:,k, 65) = rate(:,k, 65) * inv(:,k, 1)
         rate(:,k, 66) = rate(:,k, 66) * inv(:,k, 1)
         rate(:,k, 69) = rate(:,k, 69) * inv(:,k, 1)
         rate(:,k, 71) = rate(:,k, 71) * inv(:,k, 1)
         rate(:,k, 81) = rate(:,k, 81) * inv(:,k, 1)
         rate(:,k, 89) = rate(:,k, 89) * inv(:,k, 1)
         rate(:,k, 90) = rate(:,k, 90) * inv(:,k, 1)
         rate(:,k, 93) = rate(:,k, 93) * inv(:,k, 3)
         rate(:,k,104) = rate(:,k,104) * inv(:,k, 1)
         rate(:,k,109) = rate(:,k,109) * inv(:,k, 1)
         rate(:,k,115) = rate(:,k,115) * inv(:,k, 1)
         rate(:,k,141) = rate(:,k,141) * inv(:,k, 1)
         rate(:,k,175) = rate(:,k,175) * inv(:,k, 1)
         rate(:,k,176) = rate(:,k,176) * inv(:,k, 1)
         rate(:,k,211) = rate(:,k,211) * inv(:,k, 1)
         rate(:,k, 41) = rate(:,k, 41) * inv(:,k, 3) * inv(:,k, 1)
         rate(:,k, 42) = rate(:,k, 42) * m(:,k)
         rate(:,k, 46) = rate(:,k, 46) * m(:,k)
         rate(:,k, 47) = rate(:,k, 47) * m(:,k)
         rate(:,k, 48) = rate(:,k, 48) * m(:,k)
         rate(:,k, 49) = rate(:,k, 49) * m(:,k)
         rate(:,k, 50) = rate(:,k, 50) * m(:,k)
         rate(:,k, 51) = rate(:,k, 51) * m(:,k)
         rate(:,k, 52) = rate(:,k, 52) * m(:,k)
         rate(:,k, 53) = rate(:,k, 53) * m(:,k)
         rate(:,k, 54) = rate(:,k, 54) * m(:,k)
         rate(:,k, 55) = rate(:,k, 55) * m(:,k)
         rate(:,k, 56) = rate(:,k, 56) * m(:,k)
         rate(:,k, 57) = rate(:,k, 57) * m(:,k)
         rate(:,k, 58) = rate(:,k, 58) * m(:,k)
         rate(:,k, 59) = rate(:,k, 59) * m(:,k)
         rate(:,k, 60) = rate(:,k, 60) * m(:,k)
         rate(:,k, 61) = rate(:,k, 61) * m(:,k)
         rate(:,k, 62) = rate(:,k, 62) * m(:,k)
         rate(:,k, 63) = rate(:,k, 63) * m(:,k)
         rate(:,k, 64) = rate(:,k, 64) * m(:,k)
         rate(:,k, 66) = rate(:,k, 66) * m(:,k)
         rate(:,k, 67) = rate(:,k, 67) * m(:,k)
         rate(:,k, 68) = rate(:,k, 68) * m(:,k)
         rate(:,k, 69) = rate(:,k, 69) * m(:,k)
         rate(:,k, 70) = rate(:,k, 70) * m(:,k)
         rate(:,k, 72) = rate(:,k, 72) * m(:,k)
         rate(:,k, 73) = rate(:,k, 73) * m(:,k)
         rate(:,k, 74) = rate(:,k, 74) * m(:,k)
         rate(:,k, 75) = rate(:,k, 75) * m(:,k)
         rate(:,k, 76) = rate(:,k, 76) * m(:,k)
         rate(:,k, 77) = rate(:,k, 77) * m(:,k)
         rate(:,k, 78) = rate(:,k, 78) * m(:,k)
         rate(:,k, 79) = rate(:,k, 79) * m(:,k)
         rate(:,k, 80) = rate(:,k, 80) * m(:,k)
         rate(:,k, 81) = rate(:,k, 81) * m(:,k)
         rate(:,k, 82) = rate(:,k, 82) * m(:,k)
         rate(:,k, 83) = rate(:,k, 83) * m(:,k)
         rate(:,k, 84) = rate(:,k, 84) * m(:,k)
         rate(:,k, 85) = rate(:,k, 85) * m(:,k)
         rate(:,k, 87) = rate(:,k, 87) * m(:,k)
         rate(:,k, 88) = rate(:,k, 88) * m(:,k)
         rate(:,k, 89) = rate(:,k, 89) * m(:,k)
         rate(:,k, 90) = rate(:,k, 90) * m(:,k)
         rate(:,k, 91) = rate(:,k, 91) * m(:,k)
         rate(:,k, 92) = rate(:,k, 92) * m(:,k)
         rate(:,k, 95) = rate(:,k, 95) * m(:,k)
         rate(:,k, 96) = rate(:,k, 96) * m(:,k)
         rate(:,k, 97) = rate(:,k, 97) * m(:,k)
         rate(:,k, 98) = rate(:,k, 98) * m(:,k)
         rate(:,k, 99) = rate(:,k, 99) * m(:,k)
         rate(:,k,100) = rate(:,k,100) * m(:,k)
         rate(:,k,101) = rate(:,k,101) * m(:,k)
         rate(:,k,102) = rate(:,k,102) * m(:,k)
         rate(:,k,103) = rate(:,k,103) * m(:,k)
         rate(:,k,104) = rate(:,k,104) * m(:,k)
         rate(:,k,105) = rate(:,k,105) * m(:,k)
         rate(:,k,106) = rate(:,k,106) * m(:,k)
         rate(:,k,107) = rate(:,k,107) * m(:,k)
         rate(:,k,108) = rate(:,k,108) * m(:,k)
         rate(:,k,110) = rate(:,k,110) * m(:,k)
         rate(:,k,111) = rate(:,k,111) * m(:,k)
         rate(:,k,112) = rate(:,k,112) * m(:,k)
         rate(:,k,113) = rate(:,k,113) * m(:,k)
         rate(:,k,114) = rate(:,k,114) * m(:,k)
         rate(:,k,115) = rate(:,k,115) * m(:,k)
         rate(:,k,116) = rate(:,k,116) * m(:,k)
         rate(:,k,117) = rate(:,k,117) * m(:,k)
         rate(:,k,118) = rate(:,k,118) * m(:,k)
         rate(:,k,119) = rate(:,k,119) * m(:,k)
         rate(:,k,120) = rate(:,k,120) * m(:,k)
         rate(:,k,121) = rate(:,k,121) * m(:,k)
         rate(:,k,122) = rate(:,k,122) * m(:,k)
         rate(:,k,123) = rate(:,k,123) * m(:,k)
         rate(:,k,124) = rate(:,k,124) * m(:,k)
         rate(:,k,125) = rate(:,k,125) * m(:,k)
         rate(:,k,126) = rate(:,k,126) * m(:,k)
         rate(:,k,127) = rate(:,k,127) * m(:,k)
         rate(:,k,128) = rate(:,k,128) * m(:,k)
         rate(:,k,129) = rate(:,k,129) * m(:,k)
         rate(:,k,130) = rate(:,k,130) * m(:,k)
         rate(:,k,131) = rate(:,k,131) * m(:,k)
         rate(:,k,132) = rate(:,k,132) * m(:,k)
         rate(:,k,133) = rate(:,k,133) * m(:,k)
         rate(:,k,134) = rate(:,k,134) * m(:,k)
         rate(:,k,135) = rate(:,k,135) * m(:,k)
         rate(:,k,136) = rate(:,k,136) * m(:,k)
         rate(:,k,137) = rate(:,k,137) * m(:,k)
         rate(:,k,138) = rate(:,k,138) * m(:,k)
         rate(:,k,139) = rate(:,k,139) * m(:,k)
         rate(:,k,140) = rate(:,k,140) * m(:,k)
         rate(:,k,141) = rate(:,k,141) * m(:,k)
         rate(:,k,142) = rate(:,k,142) * m(:,k)
         rate(:,k,143) = rate(:,k,143) * m(:,k)
         rate(:,k,144) = rate(:,k,144) * m(:,k)
         rate(:,k,145) = rate(:,k,145) * m(:,k)
         rate(:,k,146) = rate(:,k,146) * m(:,k)
         rate(:,k,147) = rate(:,k,147) * m(:,k)
         rate(:,k,148) = rate(:,k,148) * m(:,k)
         rate(:,k,149) = rate(:,k,149) * m(:,k)
         rate(:,k,150) = rate(:,k,150) * m(:,k)
         rate(:,k,151) = rate(:,k,151) * m(:,k)
         rate(:,k,152) = rate(:,k,152) * m(:,k)
         rate(:,k,153) = rate(:,k,153) * m(:,k)
         rate(:,k,154) = rate(:,k,154) * m(:,k)
         rate(:,k,155) = rate(:,k,155) * m(:,k)
         rate(:,k,156) = rate(:,k,156) * m(:,k)
         rate(:,k,157) = rate(:,k,157) * m(:,k)
         rate(:,k,158) = rate(:,k,158) * m(:,k)
         rate(:,k,159) = rate(:,k,159) * m(:,k)
         rate(:,k,160) = rate(:,k,160) * m(:,k)
         rate(:,k,161) = rate(:,k,161) * m(:,k)
         rate(:,k,162) = rate(:,k,162) * m(:,k)
         rate(:,k,163) = rate(:,k,163) * m(:,k)
         rate(:,k,164) = rate(:,k,164) * m(:,k)
         rate(:,k,165) = rate(:,k,165) * m(:,k)
         rate(:,k,166) = rate(:,k,166) * m(:,k)
         rate(:,k,167) = rate(:,k,167) * m(:,k)
         rate(:,k,168) = rate(:,k,168) * m(:,k)
         rate(:,k,169) = rate(:,k,169) * m(:,k)
         rate(:,k,170) = rate(:,k,170) * m(:,k)
         rate(:,k,171) = rate(:,k,171) * m(:,k)
         rate(:,k,172) = rate(:,k,172) * m(:,k)
         rate(:,k,173) = rate(:,k,173) * m(:,k)
         rate(:,k,174) = rate(:,k,174) * m(:,k)
         rate(:,k,175) = rate(:,k,175) * m(:,k)
         rate(:,k,177) = rate(:,k,177) * m(:,k)
         rate(:,k,178) = rate(:,k,178) * m(:,k)
         rate(:,k,179) = rate(:,k,179) * m(:,k)
         rate(:,k,180) = rate(:,k,180) * m(:,k)
         rate(:,k,181) = rate(:,k,181) * m(:,k)
         rate(:,k,182) = rate(:,k,182) * m(:,k)
         rate(:,k,183) = rate(:,k,183) * m(:,k)
         rate(:,k,184) = rate(:,k,184) * m(:,k)
         rate(:,k,185) = rate(:,k,185) * m(:,k)
         rate(:,k,186) = rate(:,k,186) * m(:,k)
         rate(:,k,187) = rate(:,k,187) * m(:,k)
         rate(:,k,188) = rate(:,k,188) * m(:,k)
         rate(:,k,189) = rate(:,k,189) * m(:,k)
         rate(:,k,190) = rate(:,k,190) * m(:,k)
         rate(:,k,191) = rate(:,k,191) * m(:,k)
         rate(:,k,192) = rate(:,k,192) * m(:,k)
         rate(:,k,193) = rate(:,k,193) * m(:,k)
         rate(:,k,194) = rate(:,k,194) * m(:,k)
         rate(:,k,195) = rate(:,k,195) * m(:,k)
         rate(:,k,196) = rate(:,k,196) * m(:,k)
         rate(:,k,197) = rate(:,k,197) * m(:,k)
         rate(:,k,198) = rate(:,k,198) * m(:,k)
         rate(:,k,204) = rate(:,k,204) * m(:,k)
         rate(:,k,205) = rate(:,k,205) * m(:,k)
         rate(:,k,206) = rate(:,k,206) * m(:,k)
         rate(:,k,207) = rate(:,k,207) * m(:,k)
         rate(:,k,208) = rate(:,k,208) * m(:,k)
         rate(:,k,211) = rate(:,k,211) * m(:,k)
         rate(:,k,212) = rate(:,k,212) * m(:,k)
      end do

      end subroutine adjrxt

      end module mo_adjrxt
